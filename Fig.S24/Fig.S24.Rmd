---
title: "R Notebook"
output:
  pdf_document: default
  html_notebook: default
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code.

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Cmd+Shift+Enter*.

```{r}
library(tidyverse)
library(ggplot2)
library(ComplexHeatmap)
library(circlize)
```

```{r}

```

```{r}

```

```{r}

```

```{r}

```

```{r}

```

```{r}

```

```{r}

```

```{r}

```

```{r}

```

```{r}

```

```{r}

```

```{r}

```

```{r}

```

```{r}

```

```{r}

```

```{r}

```

```{r}

```

```{r}

```

```{r}

```

```{r}

```

```{r}
AMR_SIR_imp6_new <- read_csv("figS24b.csv")
AMR_SIR_imp6_new
```

```{r}
AMR_SIR_imp6_new_1 = AMR_SIR_imp6_new[, 2:22]
AMR_SIR_imp6_new_1
```

```{r}
ht_opt(RESET = TRUE)
ht_opt(heatmap_column_title_gp = gpar(fontsize = 10),
    legend_border = "black",
    heatmap_border = TRUE,
    annotation_border = TRUE)
AMR_SIR_imp6_1_h <- as.matrix(AMR_SIR_imp6_new_1[,-1])
#rownames(AMR_SIR_h) <- c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95)
rownames(AMR_SIR_imp6_new_1) <- c('JBBBAAB-19-0138', 'JBBDAAB-19-0011', 'JBBDABE-19-0091', 'JBBDACI-19-0018', 'JBBDAEE-19-0024', 'JBCDAAB-19-0064', 'JBCDADE-19-0014', 'JBCEACC-19-0030', 'JBCHAAB-19-0056', 'JBCHACG-19-0426', 'JBCHACG-19-0462', 'JBCIAAH-19-0097', 'JBCIAAH-19-0136', 'JBCIAAH-19-0233', 'JBCIACA-19-0215', 'JBCIACA-19-0354', 'JBCIACA-19-0363', 'JBCIACE-19-0140', 'JBCIACE-19-0271', 'JBCJAAB-19-0005', 'JBDDABD-19-0067', 'JBDDABD-19-0095', 'JBDJAAE-19-0069', 'JBEAAFA-19-0228')
ha2 = rowAnnotation(kbp = anno_points(c(274.292, 295.301, 280.639, 52.953, 52.953, 125.014, 53.613, 52.449, 52.301, 225.562, 50.554, 52.003, 139.295, 50.451, 47.964, 53.586, 53.584, 53.666, 52.413, 52.338, 58.164, 60.623, 52.448, 52.338), width = unit(1.5, "cm"), labels = c("100kb", "200kb", "300kb", "400kb")))
col_fun = colorRamp2(c(0, 100), c("gray", "magenta"))
h2 = Heatmap(AMR_SIR_imp6_new_1, cluster_rows = FALSE, cluster_columns = FALSE, rect_gp = gpar(col = "black", lwd = 0.2), row_names_gp = gpar(fontsize = 5.0), column_names_gp = gpar(fontsize = 9), right_annotation = ha2, row_labels = c('JBBBAAB-19-0138', 'JBBDAAB-19-0011', 'JBBDABE-19-0091', 'JBBDACI-19-0018', 'JBBDAEE-19-0024', 'JBCDAAB-19-0064', 'JBCDADE-19-0014', 'JBCEACC-19-0030', 'JBCHAAB-19-0056', 'JBCHACG-19-0426', 'JBCHACG-19-0462', 'JBCIAAH-19-0097', 'JBCIAAH-19-0136', 'JBCIAAH-19-0233', 'JBCIACA-19-0215', 'JBCIACA-19-0354', 'JBCIACA-19-0363', 'JBCIACE-19-0140', 'JBCIACE-19-0271', 'JBCJAAB-19-0005', 'JBDDABD-19-0067', 'JBDDABD-19-0095', 'JBDJAAE-19-0069', 'JBEAAFA-19-0228'), col=col_fun)
h2
```

Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Cmd+Option+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Cmd+Shift+K* to preview the HTML file).

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.

```{r}
#SIR_MLST_imp6_new_a = AMR_SIR_imp6_new["MLST"]
SIR_Inc_imp6_new_1 = AMR_SIR_imp6_new["Inc_type"]
SIR_Strain_imp6_new_1 = AMR_SIR_imp6_new["Pi chart"]
SIR_Region_imp6_new_1 = AMR_SIR_imp6_new["X axis (region)"]
```

```{r}
```

```{r}
SIR_Inc_1 <- as.matrix(AMR_SIR_imp6_new[,-1])
rownames(SIR_Inc_1) <- c('JBBBAAB-19-0138', 'JBBDAAB-19-0011', 'JBBDABE-19-0091', 'JBBDACI-19-0018', 'JBBDAEE-19-0024', 'JBCDAAB-19-0064', 'JBCDADE-19-0014', 'JBCEACC-19-0030', 'JBCHAAB-19-0056', 'JBCHACG-19-0426', 'JBCHACG-19-0462', 'JBCIAAH-19-0097', 'JBCIAAH-19-0136', 'JBCIAAH-19-0233', 'JBCIACA-19-0215', 'JBCIACA-19-0354', 'JBCIACA-19-0363', 'JBCIACE-19-0140', 'JBCIACE-19-0271', 'JBCJAAB-19-0005', 'JBDDABD-19-0067', 'JBDDABD-19-0095', 'JBDJAAE-19-0069', 'JBEAAFA-19-0228')
colors_Inc = structure(c("#AB6418", "#7D2A88", "green", "pink", "blue"), names = c("N", "HI2", "FIA-FIB-N", "N-FIB", "FIA-FII-N"))
h_Inc = Heatmap(SIR_Inc_imp6_new_1, column_labels="Inc type", width = unit(0.4, "cm"), border = TRUE, col = colors_Inc, cluster_rows = TRUE)
h_Inc
```

```{r}
SIR_Strain_imp6_1 <- as.matrix(AMR_SIR_imp6_new[,-1])
rownames(SIR_Strain_imp6_1) <- c('JBBBAAB-19-0138', 'JBBDAAB-19-0011', 'JBBDABE-19-0091', 'JBBDACI-19-0018', 'JBBDAEE-19-0024', 'JBCDAAB-19-0064', 'JBCDADE-19-0014', 'JBCEACC-19-0030', 'JBCHAAB-19-0056', 'JBCHACG-19-0426', 'JBCHACG-19-0462', 'JBCIAAH-19-0097', 'JBCIAAH-19-0136', 'JBCIAAH-19-0233', 'JBCIACA-19-0215', 'JBCIACA-19-0354', 'JBCIACA-19-0363', 'JBCIACE-19-0140', 'JBCIACE-19-0271', 'JBCJAAB-19-0005', 'JBDDABD-19-0067', 'JBDDABD-19-0095', 'JBDJAAE-19-0069', 'JBEAAFA-19-0228')
colors_Strain = structure(c("blue2", "deeppink", "darkorange1", "green3"), names = c("Citrobacter freundii", "Enterobacter spp", "Escherichia coli", "Klebsiella spp"))
h_Strain_1 = Heatmap(SIR_Strain_imp6_new_1, column_labels="Species", width = unit(0.4, "cm"), border = TRUE, col = colors_Strain)
h_Strain_1

SIR_imp6_new = AMR_SIR_imp6_new[, 23:36]
SIR_imp6_new
```

```{r}
SIR_imp6_1 <- as.matrix(AMR_SIR_imp6_new[,-1])
rownames(SIR_imp6_1) <- c('JBBBAAB-19-0138', 'JBBDAAB-19-0011', 'JBBDABE-19-0091', 'JBBDACI-19-0018', 'JBBDAEE-19-0024', 'JBCDAAB-19-0064', 'JBCDADE-19-0014', 'JBCEACC-19-0030', 'JBCHAAB-19-0056', 'JBCHACG-19-0426', 'JBCHACG-19-0462', 'JBCIAAH-19-0097', 'JBCIAAH-19-0136', 'JBCIAAH-19-0233', 'JBCIACA-19-0215', 'JBCIACA-19-0354', 'JBCIACA-19-0363', 'JBCIACE-19-0140', 'JBCIACE-19-0271', 'JBCJAAB-19-0005', 'JBDDABD-19-0067', 'JBDDABD-19-0095', 'JBDJAAE-19-0069', 'JBEAAFA-19-0228')
#colors_Region = structure(c("#96AAD6", "#D6C396", "#8BD68E", "#D6A1B8", "#D6D459"), names = c("North", "East", "Middle", "West", "Southwest"))
colors_SIR = structure(c("darkblue", "yellow", "red"), names = c("S", "I", "R"))
h_SIR = Heatmap(SIR_imp6_new, border = TRUE, col = colors_SIR, column_labels = c("IPM", "MEPM", "DRPM", "PIPC/TAZ", "AZT", "GM", "TOB", "AMK", "LVFX", "CPFX", "MINO", "ST", "CL", "CP"), column_names_gp = gpar(fontsize = 8))
h_SIR
```

```{r}
SIR_Region_imp6_1 <- as.matrix(AMR_SIR_imp6_new[,-1])
rownames(SIR_Region_imp6_1) <- c('JBBBAAB-19-0138', 'JBBDAAB-19-0011', 'JBBDABE-19-0091', 'JBBDACI-19-0018', 'JBBDAEE-19-0024', 'JBCDAAB-19-0064', 'JBCDADE-19-0014', 'JBCEACC-19-0030', 'JBCHAAB-19-0056', 'JBCHACG-19-0426', 'JBCHACG-19-0462', 'JBCIAAH-19-0097', 'JBCIAAH-19-0136', 'JBCIAAH-19-0233', 'JBCIACA-19-0215', 'JBCIACA-19-0354', 'JBCIACA-19-0363', 'JBCIACE-19-0140', 'JBCIACE-19-0271', 'JBCJAAB-19-0005', 'JBDDABD-19-0067', 'JBDDABD-19-0095', 'JBDJAAE-19-0069', 'JBEAAFA-19-0228')
#colors_Region = structure(c("#96AAD6", "#D6C396", "#8BD68E", "#D6A1B8", "#D6D459"), names = c("North", "East", "Middle", "West", "Southwest"))
colors_Region = structure(c("#AADDAA", "#FFFF33", "#00AAEE", "#FFBB99"), names = c("East", "Middle", "West", "Southwest"))
h_reion_1 = Heatmap(SIR_Region_imp6_new_1, column_labels="Region", width = unit(0.4, "cm"), border = TRUE, col = colors_Region)
h_reion_1
```

```{r}
h_all = h_reion_1 + h_Strain_1 + h_SIR + h_Inc + h2
```

```{r}
AMR_SIR_imp1 = read_csv("figS24a.csv")
AMR_SIR_imp1
```

```{r}
AMR_SIR_imp1_1 = AMR_SIR_imp1[, 2:28]
AMR_SIR_imp1_1

```

```{r}
ht_opt(RESET = TRUE)
ht_opt(heatmap_column_title_gp = gpar(fontsize = 10),
    legend_border = "black",
    heatmap_border = TRUE,
    annotation_border = TRUE)
AMR_SIR_h <- as.matrix(AMR_SIR_imp1_1[,-1])
#rownames(AMR_SIR_h) <- c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95)
rownames(AMR_SIR_h) <- c('JBAGABE-19-0015', 'JBAGABE-19-0111', 'JBAGABE-19-0081', 'JBAGABE-19-0080', 'JBAGABE-19-0008', 'JBAGABE-19-0007', 'JBAGAAD-19-0142', 'JBAGABE-19-0119', 'JBAGABE-19-0121', 'JBAGABE-19-0120', 'JBAGABE-19-0098', 'JBBDAFG-19-0049', 'JBBDAFG-19-0159', 'JBBDAFG-19-0261', 'JBBDAFG-19-0030', 'JBBDABA-19-0009', 'JBBDAAF-19-0020', 'JBBDAAF-19-0006', 'JBBDAFH-19-0097', 'JBBDAFG-19-0138', 'JBBDAFG-19-0102', 'JBBDAAF-19-0002', 'JBBDAAF-19-0029', 'JBBDAJB-19-0065', 'JBBDAJB-19-0064', 'JBBDAJB-19-0040', 'JBBDAJB-19-0039', 'JBBDAJB-19-0038', 'JBBDAJB-19-0036', 'JBBDAAF-19-0040', 'JBBDAJB-19-0035', 'JBBDAJB-19-0033', 'JBBDAJB-19-0031', 'JBBDAJB-19-0030', 'JBBDAJB-19-0023', 'JBBDAJB-19-0020', 'JBBDAJB-19-0015', 'JBBDAJB-19-0014', 'JBBDAJB-19-0034', 'JBAIAAD-19-0002', 'JBBDAFG-19-0081', 'JBBEABA-19-0004', 'JBBEAAJ-19-0007', 'JBBDAJA-19-0064', 'JBBDAGF-19-0034', 'JBBDAFI-19-0029', 'JBBDADH-19-0027', 'JBBDACE-19-0026', 'JBBDABA-19-0004', 'JBBDABA-19-0001', 'JBBDAAJ-19-0055', 'JBBDAAJ-19-0051', 'JBBEABA-19-0025', 'JBBDAAF-19-0060', 'JBBDAAE-19-0031', 'JBBDAAB-19-0067', 'JBBDAAB-19-0007', 'JBBCADC-19-0142', 'JBBCAAG-19-0002', 'JBBCAAG-19-0001', 'JBBBAEF-19-0111', 'JBBBAAI-19-0002', 'JBAJAAJ-19-0001', 'JBAIAAD-19-0071', 'JBBDAAF-19-0018', 'JBBEABG-19-0022', 'JBBEABG-19-0001', 'JBBEADF-19-0334', 'JBBEABG-19-0028', 'JBBEABG-19-0026', 'JBBEADE-19-0280', 'JBBEABG-19-0038', 'JBBEADA-19-0164', 'JBCAAAI-19-0110', 'JBCDAAB-19-0006', 'JBCHACG-19-0326', 'JBCHAFC-19-0010', 'JBCHAFC-19-0006', 'JBCHAFC-19-0005', 'JBCHAFC-19-0001', 'JBCIACA-19-0486', 'JBCHACG-19-0271', 'JBEAAAD-19-0047', 'JBEAAEE-19-0042', 'JBEAAEE-19-0002', 'JBEAAEI-19-0154', 'JBEAAAI-19-0004', 'JBEAAAI-19-0005', 'JBEAAAI-19-0008', 'JBEAAEE-19-0022', 'JBEAAEE-19-0118', 'JBEAAEE-19-0154', 'JBEAAEE-19-0155', 'JBEAAEE-19-0043_M2', 'JBEAAAD-19-0046', 'JBEAAEE-19-0043_HI2')
ha2 = rowAnnotation(kbp = anno_points(c(268.211, 50.206, 48.377, 51.813, 50.208, 50.208, 45.513, 55.204, 50.208, 299.497, 326.632, 94.175, 81.133, 76.66, 99.044, 83.464, 76.661, 85.471, 360.857, 81.133, 59.101, 76.661, 372.071, 50.906, 50.906, 51.611, 47.476, 51.603, 51.537, 67.431, 51.609, 51.604, 51.611, 51.233, 36.277, 63.465, 63.84, 36.273, 70.956, 98.919, 81.123, 367.613, 316.258, 395.479, 357.768, 387.309, 394.039, 327.701, 322.604, 306.625, 330.864, 321.01, 392.406, 283.44, 368.517, 334.054, 371.34, 316.701, 317.592, 359.986, 333.31, 335.956, 360.298, 377.452, 372.009, 296.549, 331.385, 358.826, 321.769, 217.275, 297.302, 296.549, 290.663, 331.197, 279.634, 50.564, 91.016, 91.016, 91.016, 91.016, 53.586, 97.227, 368.949, 354.164, 370.574, 80.751, 91.016, 92.53, 82.206, 78.229, 81.898, 90.364, 82.206, 78.229, 86.401, 354.175), width = unit(1.5, "cm"), labels = c("100kb", "200kb", "300kb", "400kb")))
col_fun = colorRamp2(c(0, 100), c("gray", "magenta"))
h1 = Heatmap(AMR_SIR_imp1_1, cluster_rows = FALSE, cluster_columns = FALSE, rect_gp = gpar(col = "black", lwd = 0.2), row_names_gp = gpar(fontsize = 5.0), column_names_gp = gpar(fontsize = 9), right_annotation = ha2, row_labels = c('JBAGABE-19-0015', 'JBAGABE-19-0111', 'JBAGABE-19-0081', 'JBAGABE-19-0080', 'JBAGABE-19-0008', 'JBAGABE-19-0007', 'JBAGAAD-19-0142', 'JBAGABE-19-0119', 'JBAGABE-19-0121', 'JBAGABE-19-0120', 'JBAGABE-19-0098', 'JBBDAFG-19-0049', 'JBBDAFG-19-0159', 'JBBDAFG-19-0261', 'JBBDAFG-19-0030', 'JBBDABA-19-0009', 'JBBDAAF-19-0020', 'JBBDAAF-19-0006', 'JBBDAFH-19-0097', 'JBBDAFG-19-0138', 'JBBDAFG-19-0102', 'JBBDAAF-19-0002', 'JBBDAAF-19-0029', 'JBBDAJB-19-0065', 'JBBDAJB-19-0064', 'JBBDAJB-19-0040', 'JBBDAJB-19-0039', 'JBBDAJB-19-0038', 'JBBDAJB-19-0036', 'JBBDAAF-19-0040', 'JBBDAJB-19-0035', 'JBBDAJB-19-0033', 'JBBDAJB-19-0031', 'JBBDAJB-19-0030', 'JBBDAJB-19-0023', 'JBBDAJB-19-0020', 'JBBDAJB-19-0015', 'JBBDAJB-19-0014', 'JBBDAJB-19-0034', 'JBAIAAD-19-0002', 'JBBDAFG-19-0081', 'JBBEABA-19-0004', 'JBBEAAJ-19-0007', 'JBBDAJA-19-0064', 'JBBDAGF-19-0034', 'JBBDAFI-19-0029', 'JBBDADH-19-0027', 'JBBDACE-19-0026', 'JBBDABA-19-0004', 'JBBDABA-19-0001', 'JBBDAAJ-19-0055', 'JBBDAAJ-19-0051', 'JBBEABA-19-0025', 'JBBDAAF-19-0060', 'JBBDAAE-19-0031', 'JBBDAAB-19-0067', 'JBBDAAB-19-0007', 'JBBCADC-19-0142', 'JBBCAAG-19-0002', 'JBBCAAG-19-0001', 'JBBBAEF-19-0111', 'JBBBAAI-19-0002', 'JBAJAAJ-19-0001', 'JBAIAAD-19-0071', 'JBBDAAF-19-0018', 'JBBEABG-19-0022', 'JBBEABG-19-0001', 'JBBEADF-19-0334', 'JBBEABG-19-0028', 'JBBEABG-19-0026', 'JBBEADE-19-0280', 'JBBEABG-19-0038', 'JBBEADA-19-0164', 'JBCAAAI-19-0110', 'JBCDAAB-19-0006', 'JBCHACG-19-0326', 'JBCHAFC-19-0010', 'JBCHAFC-19-0006', 'JBCHAFC-19-0005', 'JBCHAFC-19-0001', 'JBCIACA-19-0486', 'JBCHACG-19-0271', 'JBEAAAD-19-0047', 'JBEAAEE-19-0042', 'JBEAAEE-19-0002', 'JBEAAEI-19-0154', 'JBEAAAI-19-0004', 'JBEAAAI-19-0005', 'JBEAAAI-19-0008', 'JBEAAEE-19-0022', 'JBEAAEE-19-0118', 'JBEAAEE-19-0154', 'JBEAAEE-19-0155', 'JBEAAEE-19-0043_M2', 'JBEAAAD-19-0046', 'JBEAAEE-19-0043_HI2'), col=col_fun)
```

```{r}
#SIR_MLST_imp1 = AMR_SIR_imp1["MLST"]
SIR_Inc_imp1 = AMR_SIR_imp1["Y axis (abbribiation)"]
SIR_Strain_imp1 = AMR_SIR_imp1["Pi chart"]
SIR_Region_imp1 = AMR_SIR_imp1["X axis (region)"]
```

```{r}
SIR_Inc_imp1_1 <- as.matrix(SIR_Inc_imp1[,-1])
rownames(SIR_Inc_imp1_1) <- c('JBAGABE-19-0015', 'JBAGABE-19-0111', 'JBAGABE-19-0081', 'JBAGABE-19-0080', 'JBAGABE-19-0008', 'JBAGABE-19-0007', 'JBAGAAD-19-0142', 'JBAGABE-19-0119', 'JBAGABE-19-0121', 'JBAGABE-19-0120', 'JBAGABE-19-0098', 'JBBDAFG-19-0049', 'JBBDAFG-19-0159', 'JBBDAFG-19-0261', 'JBBDAFG-19-0030', 'JBBDABA-19-0009', 'JBBDAAF-19-0020', 'JBBDAAF-19-0006', 'JBBDAFH-19-0097', 'JBBDAFG-19-0138', 'JBBDAFG-19-0102', 'JBBDAAF-19-0002', 'JBBDAAF-19-0029', 'JBBDAJB-19-0065', 'JBBDAJB-19-0064', 'JBBDAJB-19-0040', 'JBBDAJB-19-0039', 'JBBDAJB-19-0038', 'JBBDAJB-19-0036', 'JBBDAAF-19-0040', 'JBBDAJB-19-0035', 'JBBDAJB-19-0033', 'JBBDAJB-19-0031', 'JBBDAJB-19-0030', 'JBBDAJB-19-0023', 'JBBDAJB-19-0020', 'JBBDAJB-19-0015', 'JBBDAJB-19-0014', 'JBBDAJB-19-0034', 'JBAIAAD-19-0002', 'JBBDAFG-19-0081', 'JBBEABA-19-0004', 'JBBEAAJ-19-0007', 'JBBDAJA-19-0064', 'JBBDAGF-19-0034', 'JBBDAFI-19-0029', 'JBBDADH-19-0027', 'JBBDACE-19-0026', 'JBBDABA-19-0004', 'JBBDABA-19-0001', 'JBBDAAJ-19-0055', 'JBBDAAJ-19-0051', 'JBBEABA-19-0025', 'JBBDAAF-19-0060', 'JBBDAAE-19-0031', 'JBBDAAB-19-0067', 'JBBDAAB-19-0007', 'JBBCADC-19-0142', 'JBBCAAG-19-0002', 'JBBCAAG-19-0001', 'JBBBAEF-19-0111', 'JBBBAAI-19-0002', 'JBAJAAJ-19-0001', 'JBAIAAD-19-0071', 'JBBDAAF-19-0018', 'JBBEABG-19-0022', 'JBBEABG-19-0001', 'JBBEADF-19-0334', 'JBBEABG-19-0028', 'JBBEABG-19-0026', 'JBBEADE-19-0280', 'JBBEABG-19-0038', 'JBBEADA-19-0164', 'JBCAAAI-19-0110', 'JBCDAAB-19-0006', 'JBCHACG-19-0326', 'JBCHAFC-19-0010', 'JBCHAFC-19-0006', 'JBCHAFC-19-0005', 'JBCHAFC-19-0001', 'JBCIACA-19-0486', 'JBCHACG-19-0271', 'JBEAAAD-19-0047', 'JBEAAEE-19-0042', 'JBEAAEE-19-0002', 'JBEAAEI-19-0154', 'JBEAAAI-19-0004', 'JBEAAAI-19-0005', 'JBEAAAI-19-0008', 'JBEAAEE-19-0022', 'JBEAAEE-19-0118', 'JBEAAEE-19-0154', 'JBEAAEE-19-0155', 'JBEAAEE-19-0043_M2', 'JBEAAAD-19-0046', 'JBEAAEE-19-0043_HI2')
colors_Inc = structure(c("#AB6418", "#7D2A88", "#72AB3A", "#1883AB"), names = c("N", "HI2", "M1", "M2"))
h_Inc = Heatmap(SIR_Inc_imp1, width = unit(0.4, "cm"), column_labels="Inc type", border = TRUE, col = colors_Inc, cluster_rows = TRUE)
```

```{r}
SIR_Strain_imp1_1 <- as.matrix(SIR_Strain_imp1[,-1])
rownames(SIR_Strain_imp1_1) <- c('JBAGABE-19-0015', 'JBAGABE-19-0111', 'JBAGABE-19-0081', 'JBAGABE-19-0080', 'JBAGABE-19-0008', 'JBAGABE-19-0007', 'JBAGAAD-19-0142', 'JBAGABE-19-0119', 'JBAGABE-19-0121', 'JBAGABE-19-0120', 'JBAGABE-19-0098', 'JBBDAFG-19-0049', 'JBBDAFG-19-0159', 'JBBDAFG-19-0261', 'JBBDAFG-19-0030', 'JBBDABA-19-0009', 'JBBDAAF-19-0020', 'JBBDAAF-19-0006', 'JBBDAFH-19-0097', 'JBBDAFG-19-0138', 'JBBDAFG-19-0102', 'JBBDAAF-19-0002', 'JBBDAAF-19-0029', 'JBBDAJB-19-0065', 'JBBDAJB-19-0064', 'JBBDAJB-19-0040', 'JBBDAJB-19-0039', 'JBBDAJB-19-0038', 'JBBDAJB-19-0036', 'JBBDAAF-19-0040', 'JBBDAJB-19-0035', 'JBBDAJB-19-0033', 'JBBDAJB-19-0031', 'JBBDAJB-19-0030', 'JBBDAJB-19-0023', 'JBBDAJB-19-0020', 'JBBDAJB-19-0015', 'JBBDAJB-19-0014', 'JBBDAJB-19-0034', 'JBAIAAD-19-0002', 'JBBDAFG-19-0081', 'JBBEABA-19-0004', 'JBBEAAJ-19-0007', 'JBBDAJA-19-0064', 'JBBDAGF-19-0034', 'JBBDAFI-19-0029', 'JBBDADH-19-0027', 'JBBDACE-19-0026', 'JBBDABA-19-0004', 'JBBDABA-19-0001', 'JBBDAAJ-19-0055', 'JBBDAAJ-19-0051', 'JBBEABA-19-0025', 'JBBDAAF-19-0060', 'JBBDAAE-19-0031', 'JBBDAAB-19-0067', 'JBBDAAB-19-0007', 'JBBCADC-19-0142', 'JBBCAAG-19-0002', 'JBBCAAG-19-0001', 'JBBBAEF-19-0111', 'JBBBAAI-19-0002', 'JBAJAAJ-19-0001', 'JBAIAAD-19-0071', 'JBBDAAF-19-0018', 'JBBEABG-19-0022', 'JBBEABG-19-0001', 'JBBEADF-19-0334', 'JBBEABG-19-0028', 'JBBEABG-19-0026', 'JBBEADE-19-0280', 'JBBEABG-19-0038', 'JBBEADA-19-0164', 'JBCAAAI-19-0110', 'JBCDAAB-19-0006', 'JBCHACG-19-0326', 'JBCHAFC-19-0010', 'JBCHAFC-19-0006', 'JBCHAFC-19-0005', 'JBCHAFC-19-0001', 'JBCIACA-19-0486', 'JBCHACG-19-0271', 'JBEAAAD-19-0047', 'JBEAAEE-19-0042', 'JBEAAEE-19-0002', 'JBEAAEI-19-0154', 'JBEAAAI-19-0004', 'JBEAAAI-19-0005', 'JBEAAAI-19-0008', 'JBEAAEE-19-0022', 'JBEAAEE-19-0118', 'JBEAAEE-19-0154', 'JBEAAEE-19-0155', 'JBEAAEE-19-0043_M2', 'JBEAAAD-19-0046', 'JBEAAEE-19-0043_HI2')
colors_Strain = structure(c("blue2", "deeppink", "darkorange1", "green3", "gray"), names = c("Citrobacter freundii", "Enterobacter spp", "Escherichia coli", "Klebsiella spp", "others"))
h_Strain_1 = Heatmap(SIR_Strain_imp1, column_labels="Species", width = unit(0.4, "cm"), border = TRUE, col = colors_Strain)

```

```{r}
SIR_Region_imp1_1 <- as.matrix(SIR_Region_imp1[,-1])
rownames(SIR_Region_imp1_1) <- c('JBAGABE-19-0015', 'JBAGABE-19-0111', 'JBAGABE-19-0081', 'JBAGABE-19-0080', 'JBAGABE-19-0008', 'JBAGABE-19-0007', 'JBAGAAD-19-0142', 'JBAGABE-19-0119', 'JBAGABE-19-0121', 'JBAGABE-19-0120', 'JBAGABE-19-0098', 'JBBDAFG-19-0049', 'JBBDAFG-19-0159', 'JBBDAFG-19-0261', 'JBBDAFG-19-0030', 'JBBDABA-19-0009', 'JBBDAAF-19-0020', 'JBBDAAF-19-0006', 'JBBDAFH-19-0097', 'JBBDAFG-19-0138', 'JBBDAFG-19-0102', 'JBBDAAF-19-0002', 'JBBDAAF-19-0029', 'JBBDAJB-19-0065', 'JBBDAJB-19-0064', 'JBBDAJB-19-0040', 'JBBDAJB-19-0039', 'JBBDAJB-19-0038', 'JBBDAJB-19-0036', 'JBBDAAF-19-0040', 'JBBDAJB-19-0035', 'JBBDAJB-19-0033', 'JBBDAJB-19-0031', 'JBBDAJB-19-0030', 'JBBDAJB-19-0023', 'JBBDAJB-19-0020', 'JBBDAJB-19-0015', 'JBBDAJB-19-0014', 'JBBDAJB-19-0034', 'JBAIAAD-19-0002', 'JBBDAFG-19-0081', 'JBBEABA-19-0004', 'JBBEAAJ-19-0007', 'JBBDAJA-19-0064', 'JBBDAGF-19-0034', 'JBBDAFI-19-0029', 'JBBDADH-19-0027', 'JBBDACE-19-0026', 'JBBDABA-19-0004', 'JBBDABA-19-0001', 'JBBDAAJ-19-0055', 'JBBDAAJ-19-0051', 'JBBEABA-19-0025', 'JBBDAAF-19-0060', 'JBBDAAE-19-0031', 'JBBDAAB-19-0067', 'JBBDAAB-19-0007', 'JBBCADC-19-0142', 'JBBCAAG-19-0002', 'JBBCAAG-19-0001', 'JBBBAEF-19-0111', 'JBBBAAI-19-0002', 'JBAJAAJ-19-0001', 'JBAIAAD-19-0071', 'JBBDAAF-19-0018', 'JBBEABG-19-0022', 'JBBEABG-19-0001', 'JBBEADF-19-0334', 'JBBEABG-19-0028', 'JBBEABG-19-0026', 'JBBEADE-19-0280', 'JBBEABG-19-0038', 'JBBEADA-19-0164', 'JBCAAAI-19-0110', 'JBCDAAB-19-0006', 'JBCHACG-19-0326', 'JBCHAFC-19-0010', 'JBCHAFC-19-0006', 'JBCHAFC-19-0005', 'JBCHAFC-19-0001', 'JBCIACA-19-0486', 'JBCHACG-19-0271', 'JBEAAAD-19-0047', 'JBEAAEE-19-0042', 'JBEAAEE-19-0002', 'JBEAAEI-19-0154', 'JBEAAAI-19-0004', 'JBEAAAI-19-0005', 'JBEAAAI-19-0008', 'JBEAAEE-19-0022', 'JBEAAEE-19-0118', 'JBEAAEE-19-0154', 'JBEAAEE-19-0155', 'JBEAAEE-19-0043_M2', 'JBEAAAD-19-0046', 'JBEAAEE-19-0043_HI2')
#colors_Region = structure(c("#96AAD6", "#D6C396", "#8BD68E", "#D6A1B8", "#D6D459"), names = c("North", "East", "Middle", "West", "Southwest"))
colors_Region = structure(c("red", "#AADDAA", "#FFFF33", "#00AAEE", "#FFBB99"), names = c("North", "East", "Middle", "West", "Southwest"))
h_region_1 = Heatmap(SIR_Region_imp1, column_labels="Region", width = unit(0.4, "cm"), border = TRUE, col = colors_Region)
h_region_1
```

```{r}
AMR_MIC_imp1 = AMR_SIR_imp1[, 29:42]
AMR_MIC_imp1
```

```{r}
AMR_MIC_imp1_1 <- as.matrix(AMR_MIC_imp1[,-1])
rownames(AMR_MIC_imp1_1) <- c('JBAGABE-19-0015', 'JBAGABE-19-0111', 'JBAGABE-19-0081', 'JBAGABE-19-0080', 'JBAGABE-19-0008', 'JBAGABE-19-0007', 'JBAGAAD-19-0142', 'JBAGABE-19-0119', 'JBAGABE-19-0121', 'JBAGABE-19-0120', 'JBAGABE-19-0098', 'JBBDAFG-19-0049', 'JBBDAFG-19-0159', 'JBBDAFG-19-0261', 'JBBDAFG-19-0030', 'JBBDABA-19-0009', 'JBBDAAF-19-0020', 'JBBDAAF-19-0006', 'JBBDAFH-19-0097', 'JBBDAFG-19-0138', 'JBBDAFG-19-0102', 'JBBDAAF-19-0002', 'JBBDAAF-19-0029', 'JBBDAJB-19-0065', 'JBBDAJB-19-0064', 'JBBDAJB-19-0040', 'JBBDAJB-19-0039', 'JBBDAJB-19-0038', 'JBBDAJB-19-0036', 'JBBDAAF-19-0040', 'JBBDAJB-19-0035', 'JBBDAJB-19-0033', 'JBBDAJB-19-0031', 'JBBDAJB-19-0030', 'JBBDAJB-19-0023', 'JBBDAJB-19-0020', 'JBBDAJB-19-0015', 'JBBDAJB-19-0014', 'JBBDAJB-19-0034', 'JBAIAAD-19-0002', 'JBBDAFG-19-0081', 'JBBEABA-19-0004', 'JBBEAAJ-19-0007', 'JBBDAJA-19-0064', 'JBBDAGF-19-0034', 'JBBDAFI-19-0029', 'JBBDADH-19-0027', 'JBBDACE-19-0026', 'JBBDABA-19-0004', 'JBBDABA-19-0001', 'JBBDAAJ-19-0055', 'JBBDAAJ-19-0051', 'JBBEABA-19-0025', 'JBBDAAF-19-0060', 'JBBDAAE-19-0031', 'JBBDAAB-19-0067', 'JBBDAAB-19-0007', 'JBBCADC-19-0142', 'JBBCAAG-19-0002', 'JBBCAAG-19-0001', 'JBBBAEF-19-0111', 'JBBBAAI-19-0002', 'JBAJAAJ-19-0001', 'JBAIAAD-19-0071', 'JBBDAAF-19-0018', 'JBBEABG-19-0022', 'JBBEABG-19-0001', 'JBBEADF-19-0334', 'JBBEABG-19-0028', 'JBBEABG-19-0026', 'JBBEADE-19-0280', 'JBBEABG-19-0038', 'JBBEADA-19-0164', 'JBCAAAI-19-0110', 'JBCDAAB-19-0006', 'JBCHACG-19-0326', 'JBCHAFC-19-0010', 'JBCHAFC-19-0006', 'JBCHAFC-19-0005', 'JBCHAFC-19-0001', 'JBCIACA-19-0486', 'JBCHACG-19-0271', 'JBEAAAD-19-0047', 'JBEAAEE-19-0042', 'JBEAAEE-19-0002', 'JBEAAEI-19-0154', 'JBEAAAI-19-0004', 'JBEAAAI-19-0005', 'JBEAAAI-19-0008', 'JBEAAEE-19-0022', 'JBEAAEE-19-0118', 'JBEAAEE-19-0154', 'JBEAAEE-19-0155', 'JBEAAEE-19-0043_M2', 'JBEAAAD-19-0046', 'JBEAAEE-19-0043_HI2')
#colors_Region = structure(c("#96AAD6", "#D6C396", "#8BD68E", "#D6A1B8", "#D6D459"), names = c("North", "East", "Middle", "West", "Southwest"))
colors_SIR = structure(c("darkblue", "yellow", "red"), names = c("S", "I", "R"))
h_SIR = Heatmap(AMR_MIC_imp1, border = TRUE, col = colors_SIR, column_labels = c("IPM", "MEPM", "DRPM", "PIPC/TAZ", "AZT", "GM", "TOB", "AMK", "LVFX", "CPFX", "MINO", "ST", "CL", "CP"), column_names_gp = gpar(fontsize = 8))
h_SIR
```

```{r}
h_all_imp_1 = h_region_1 + h_Strain_1 + h_SIR + h_Inc + h1
```
